#!/usr/bin/env node
import { Clippy } from './index.js'
import { cliYargs } from '@kingjs/cli-yargs'
import { CliRuntime } from '@kingjs/cli-runtime'
import { hideBin } from 'yargs/helpers'

CliRuntime.activate(Clippy)
  .then(async runtime => cliYargs(await runtime.info.toPojo())
    .then(async yargs => {
      const argv = await yargs.parse(hideBin(process.argv))
      // const argv = await yargs.parse('spy info poll'.split(' '))
      // const argv = await yargs.parse('poll --stdlog --errorRate .2'.split(' '))
      // const argv = await yargs.parse('orb --stdin ./polling.txt'.split(' '))

      await runtime.execute(argv._, argv)
    })
  )
